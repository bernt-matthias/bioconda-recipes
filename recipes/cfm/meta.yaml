package:
  name: cfm
  version: "33"

source:
  # the download is a mirror of a snapshot of 
  # https://sourceforge.net/code-snapshots/svn/c/cf/cfm-id/code/cfm-id-code-r33-cfm.zip
  # which is only present for 24h or so
  - url: https://depot.galaxyproject.org/software/cfm/cfm_r33_src_all.zip
    sha256: 6518e70d2acf995d95d610312b234b5a69ee13ba0eed4836235ce32d73e32e35
    patches:
      - CMakeLists.patch
  - url: https://depot.galaxyproject.org/software/cfm/cfm-train-example_r33_src_all.zip
    sha256: 248f4b67b29690779e6aaee0a3dbe73d90945a88fe7cdb0cc93f9b65be09ef2d
    folder: train-example

build:
  number: 0

requirements:
  build:
    - {{ compiler('cxx') }}
    - cmake
  host:
    - boost-cpp
    - lp_solve
    - rdkit ==2018.09.1
  run:
    - boost-cpp
    - lp_solve
    - rdkit ==2018.09.1

# files taken from https://sourceforge.net/p/cfm-id/code/HEAD/tree/supplementary_material/cfm-train_example/train_example/
test:
  source_files:
    - example_candidates.txt
    - example_spec.txt
    - train-example/example_output/param_output1.log
    - train-example/example_param_config.txt
  commands:
    - cfm-id example_spec.txt AN_ID example_candidates.txt 5 10.0 0.01 0.001 param_output1.log example_param_config.txt DotProduct
about:
  home: https://sourceforge.net/p/cfm-id/wiki/Home/
  license: GPL-2
  summary: 'Tools for applying Competitive Fragmentation Modeling (CFM) to spectrum prediction and metabolite identification tasks, as well as a tools for fragment generation and peak annotation.'
  license_file: license.txt
